{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Malware Response (Symantec EDR \/ ATP \/ CloudSOC)",
    "aliasName": null,
    "tag": "#Post-Create#Alert",
    "description": "Remediate malware alert by blocking malicious entities",
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1646766949,
    "collection": "\/api\/3\/workflow_collections\/372ed246-8f2a-4f9c-8c1d-ee8b25affc11",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/df740be8-f2e7-488d-bc6c-747b7d19ab49",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>&nbsp;Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:<\/p>\n<p>{% if vars.input.records[0].domain %}<strong>Domain<\/strong>: {{vars.input.records[0].domain -}}{% endif %}<\/p>\n<p>{% if vars.input.records[0].sourceIp %}<strong>SourceIP<\/strong>: {{ vars.input.records[0].sourceIp -}}{% endif %}<\/p>\n<p>{% if vars.input.records[0].destinationIp %}<strong>DestinationIP<\/strong>: {{vars.input.records[0].destinationIp -}}{% endif %}<\/p>\n<p>{% if vars.input.records[0].fileHash %}<strong>File Hash<\/strong>: {{vars.input.records[0].fileHash -}}{% endif %}<\/p>\n<p>{% if vars.input.records[0].computerName %}<strong>ComputerName<\/strong>: {{vars.input.records[0].computerName -}}{% endif %}<\/p>\n<p>{% if vars.input.records[0].processName %}<strong>Process<\/strong>: {{vars.input.records[0].processName -}}{% endif %}<\/p>\n<p>{% if vars.input.records[0].sourceProcess %}<strong>SourceProcess<\/strong>: {{vars.input.records[0].sourceProcess -}}{% endif %}<\/p>\n<p>{% if vars.alertRawData.user %}<strong>Owner<\/strong>: {{vars.alertRawData.user -}}{% endif %}<\/p>\n<p>{% if vars.alertRawData.deviceUid %}<strong>Device UID<\/strong>: {{vars.alertRawData.deviceUid[0] -}}{% endif %}<\/p>\n<p>{% if vars.alertRawData.mac_address %}<strong>MAC Address<\/strong>: {{vars.alertRawData.mac_address -}}{% endif %}<\/p>",
                    "records": ""
                },
                "resource": {
                    "status": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "73d170ed-171d-4299-ac09-146e18bf66e0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get File Reputation",
            "description": null,
            "arguments": {
                "name": "Symantec DeepSight Intelligence",
                "config": "caf0ac75-91ae-46ba-b9e1-ac82128fd442",
                "params": {
                    "filehash": "{{vars.input.records[0].fileHash}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong>Symantec DeepSight<\/strong>&nbsp;suggests Filehash&nbsp;{{vars.result[0].data.result.MD5}} to be&nbsp;<strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">{{vars.result[0].data.result.reputation}}<\/span><\/strong><\/p>",
                    "records": ""
                },
                "version": "1.0.1",
                "connector": "symantec-deepsight-intelligence",
                "operation": "filehash_reputation",
                "mock_result": "[\n    {\n      \"status\": \"Success\",\n      \"data\": {\n        \"status\": \"success\",\n        \"result\": {\n          \"MD5\": \"dc4200ac514006f084ead7f83b84c928\",\n          \"reputation\": \"Malicious\",\n          \"schemaVersion\": 3,\n          \"activity\": {\n            \"tcp\": [\n              {\n                \"port\": 443,\n                \"ip\": \"13.92.82.125\"\n              },\n              {\n                \"port\": 443,\n                \"ip\": \"131.253.61.102\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"23.192.125.50\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"72.21.91.29\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"104.18.24.243\"\n              },\n              {\n                \"port\": 80,\n                \"ip\": \"208.185.118.90\"\n              }\n            ],\n            \"dns\": [\n              {\n                \"type\": \"A\",\n                \"target\": \"login.live.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.digicert.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"ocsp.msocsp.com\"\n              },\n              {\n                \"type\": \"A\",\n                \"target\": \"crl.microsoft.com\"\n              }\n            ],\n            \"urls\": [\n              {\n                \"url\": \"http:\/\/ocsp.digicert.com\/MFEwTzBNMEswSTAJBgUrDgMCGgUABBTBL0V27RVZ7LBduom%2FnYB45SPUEwQU5Z1ZMIJHWMys%2BghUNoZ7OrUETfACEAi4elAbvpzaLRZNPjlRv1U%3D\"\n              },\n              {\n                \"url\": \"http:\/\/ocsp.msocsp.com\/MFQwUjBQME4wTDAJBgUrDgMCGgUABBRPC1vZt9qvn7bzY3Iidtbhla4mKQQUWIif1tycSCK3FD7%2FhIjo5oX%2F%2Bn0CE3sAACKeWuj3CySHT1IAAAAAIp4%3D\"\n              },\n              {\n                \"url\": \"http:\/\/crl.microsoft.com\/pki\/crl\/products\/tspca.crl\"\n              }\n            ],\n            \"udp\": [\n              {\n                \"port\": 3702,\n                \"ip\": \"239.255.255.250\"\n              }\n            ]\n          },\n          \"detectionName\": \"Infostealer.Chabibase\",\n          \"SHA256\": \"a850de0705c0f6095910aa1d5ed0e73a49581aa7427fcfaf2ff5144e93b047c1\"\n        }\n      },\n      \"operation\": \"filehash_reputation\",\n      \"message\": \"\"\n    }\n  ]",
                "operationTitle": "Get File Reputation",
                "step_variables": {
                    "fileReputations": "{{vars.result | json_query(\"[*].data.result.reputation\")}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "d584d6cc-1d03-4b83-902b-184fafe7c363"
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch Assets Details",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "deviceUid",
                            "value": "{{vars.input.records[0].deviceUID}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                },
                "module": "assets?$limit=30",
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "uuid": "a9e65d2c-8da2-4691-92a3-7dc71d49ec80"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create or Link Assets",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Found Asset details corresponding to the Device UID \"{{vars.alertRawData.deviceUid[0]}}\":<br \/><strong>Owner<\/strong>: {{vars.alertRawData.user}}<br \/><strong>Hostname<\/strong>: {{vars.result.hostname}}<\/p>",
                    "records": ""
                },
                "arguments": {
                    "assetIP": "{{vars.input.records[0].destinationIp}}",
                    "indicatorIRI": "{{vars.linkedIndicatorIRI}}",
                    "assetHostname": "{% if vars.steps.Fetch_Assets_Details | length> 0 %}{{vars.steps.Fetch_Assets_Details[0].hostname}}{% else %}{{vars.alertRawData.hostname}}{% endif %}",
                    "alertRecordIRI": "{{vars.input.records[0]['@id']}}",
                    "assetMacAddress": "{{vars.alertRawData.mac_address}}",
                    "incidentRecordIRI": ""
                },
                "apply_async": false,
                "step_variables": {
                    "linkedAssetIRI": "{{vars.result['@id']}}"
                },
                "workflowReference": "\/api\/3\/workflows\/24f12289-5860-4857-ac0e-354e65f46e18"
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "40b3a444-cdc6-4e62-897e-cfd27e22d886"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">Asset Contained.<\/span><\/strong><\/p>",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 6802,
                        "@id": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Closed",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Closed",
                        "orderIndex": 1
                    },
                    "closureNotes": "<p>Asset and user Containted<\/p>"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "be20c511-16db-4f72-b20c-9169fe76f7ce"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create note for the approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Requested Approval from&nbsp;SOC team member&nbsp;to contain the User and Asset.<br><strong> <span style=\"background:#ba6204; color: #fff;\" class=\"badge badge-pill badge-danger\">Awaiting Confirmation.<\/span><\/strong><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "858ed5ba-8133-48c0-bb12-53efa9bd9310"
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify IT team to start the asset clean up process",
            "description": null,
            "arguments": {
                "name": "SMTP",
                "config": "8dcaad2a-8cc4-4156-a95e-87e420f76a1f",
                "params": {
                    "cc": "user@example.com",
                    "to": "cyopsit_team@example.com",
                    "bcc": "",
                    "from": "no-reply@cybersponse.com",
                    "content": "<p>Hi Team,<\/p>\n<p>Following asset has been isolated due to malware infection.<\/p>\n<p>Please initiate asset clean-up procedure.<\/p>\n<p>Asset details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px; float: left;\">\n<tbody>\n<tr>\n<td style=\"width: 95px;\">Owner<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].managedBy}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Device Name<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].hostname}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">IP Address<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].ip}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">Owner's Email ID<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].emailID}}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 95px;\">OS<\/td>\n<td style=\"width: 286px;\">{{vars.steps.Fetch_Assets_Details[0].operatingSystem.itemValue}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Infection details:<\/p>\n<table border=\"1px solid black\" style=\"width: 732px;\">\n<tbody>\n<tr>\n<td style=\"width: 146px;\">File Hashes&nbsp;<\/td>\n<td style=\"width: 237px;\">{% for item in vars.steps.Get_File_Reputation %}{% if \"Malicious\" in item.data.result.reputation %}{{item.data.result['SHA256']}}, {% endif %}{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>Thanks,<\/p>\n<p>InfoSec Team<\/p>",
                    "subject": "Clean Infected Asset : {{vars.steps.Fetch_Assets_Details[0].hostname}}",
                    "iri_list": "",
                    "file_name": "",
                    "file_path": ""
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Mail sent to IT Team to initiate the asset clean-up procedure.<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "2.4.3",
                "connector": "smtp",
                "operation": "send_richtext_email",
                "ignore_errors": true,
                "operationTitle": "Send Rich Text Email",
                "step_variables": []
            },
            "status": null,
            "top": "1920",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "a4a78348-4308-40c5-9fcf-e430786124f3"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Endpoint Isolation Required",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/858ed5ba-8133-48c0-bb12-53efa9bd9310",
                        "condition": "{{ \"Malicious\" in vars.fileReputations }}"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/95d6ceb4-e47d-40db-a3cf-c83212b701c4"
                    }
                ]
            },
            "status": null,
            "top": "975",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "de65e2b0-8e90-4e52-9322-02e554ecc731"
        },
        {
            "@type": "WorkflowStep",
            "name": "No malicious file found",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].type['@id']}}",
                    "content": "<p><strong><span style=\"color: #339966;\">No malicious<\/span><\/strong>&nbsp;File found<\/p>",
                    "records": ""
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "95d6ceb4-e47d-40db-a3cf-c83212b701c4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Approved Isolation",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "['{{vars.alertIRI}}']",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p><strong><span style=\"color: #008000;\">Containment request approved.<\/span><\/strong><\/p>\n<p>Proceeding to Isolate the Host<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "69153dc8-0b1f-4a7d-9f5e-e0960d183a86"
        },
        {
            "@type": "WorkflowStep",
            "name": "Seek Approval to Contain",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Approve Containment",
                        "description": "<p>Alert ID: {{vars.input.records[0].id}}<br \/>Please provide approval to contain <br \/>User: ({{vars.alertRawData.user}}) and <br \/>Endpoint (Device UID: {{vars.alertRawData.deviceUid[0]}})<\/p>",
                        "inputVariables": []
                    }
                },
                "record": "{{vars.input.records[0]['@id']}}",
                "resources": "alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Approve",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/69153dc8-0b1f-4a7d-9f5e-e0960d183a86"
                        },
                        {
                            "option": "Reject",
                            "step_iri": "\/api\/3\/workflow_steps\/db4d346e-1911-440d-9464-6da79acdf991"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "1245",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "7961d045-80f6-4ff5-8510-18df8af36cda"
        },
        {
            "@type": "WorkflowStep",
            "name": "Deactivate User in CloudSOC",
            "description": null,
            "arguments": {
                "name": "Symantec CloudSOC",
                "config": "3717065f-ef19-4c19-b038-5e3e0f86422f",
                "params": {
                    "email": "{{vars.steps.Fetch_Assets_Details[0].emailID}}",
                    "action": "Deactivate User"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>User: {{vars.alertRawData.user }} has been blocked on Symantec CloudSOC<\/p>",
                    "records": ""
                },
                "version": "1.0.0",
                "connector": "symantec-cloudsoc",
                "operation": "modify_user",
                "mock_result": "{\n    \"data\":\n    {\n    \"Status\" : \"Success\"\n    }\n}",
                "operationTitle": "Modify User Activation",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "debec9e7-c5ea-4440-be9a-5dc0724f9cec"
        },
        {
            "@type": "WorkflowStep",
            "name": "No Isolation is required",
            "description": null,
            "arguments": {
                "params": [],
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>No Isolation of endpoint is required<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "db4d346e-1911-440d-9464-6da79acdf991"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertIRI": "{{vars.input.records[0]['@id']}}",
                "alertRawData": "{{vars.input.records[0].sourcedata}}",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "linkedIndicatorIRI": "{{vars.steps.Find_Indicators[0].indicators | json_query('[].\"@id\"')}}"
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "c787c8b3-52a2-4572-94f1-04353385c2b2"
        },
        {
            "@type": "WorkflowStep",
            "name": "Delete File from Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec EDR",
                "config": "596769f3-1731-4c56-8cdb-8a637be4060b",
                "params": {
                    "hash": "{{vars.item.data.result['SHA256']}}",
                    "device_uid": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Deleted the&nbsp;<strong><span class=\"badge badge-pill badge-danger\" style=\"background: #e31b1d; color: #fff;\">malicious<\/span>&nbsp;<\/strong>file hashes from device&nbsp;<strong><span class=\"badge badge-pill badge-danger\" style=\"background: #e31b1d; color: #fff;\">{{vars.alertRawData.deviceUid[0]}}<\/span><\/strong><\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "2.0.0",
                "for_each": {
                    "item": "{{vars.steps.Get_File_Reputation}}",
                    "parallel": false,
                    "condition": "{{\"Malicious\" in vars.item.data.result.reputation or \"Trending Bad\" in vars.item.data.result.reputation}}"
                },
                "connector": "symantec-edr",
                "operation": "delete_endpoint_file",
                "mock_result": "[\n  {\n    \"command_id\": \"12daad562ddd23s12daad22ddd23s-2018-04-27\"\n  },\n  {\n    \"command_id\": \"12daad22ddd23s12daass2asd23s-2018-04-27\"\n  }\n]",
                "operationTitle": "Delete File from Endpoint",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "e3d72c73-d3e0-4900-b61d-ea442d514fd9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Isolate Endpoint",
            "description": null,
            "arguments": {
                "name": "Symantec EDR",
                "config": "596769f3-1731-4c56-8cdb-8a637be4060b",
                "params": {
                    "targets": "{{vars.request.data.deviceUID}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Device <strong>{{vars.alertRawData.deviceUid[0]}} isolated <\/strong>successfully.&nbsp;<\/p>",
                    "records": "['{{vars.alertIRI}}']"
                },
                "version": "2.0.0",
                "connector": "symantec-edr",
                "operation": "isolate_endpoint",
                "mock_result": "{\n       \"command_id\": \"12daad22ddd23s12daad22ddd23s-2018-04-27\"\n }",
                "operationTitle": "Isolate Endpoint",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "96e0594d-b578-4b45-aa0a-acba89cdb6af"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "a9e4f267-4e6f-4e89-960c-b4c5a232031d",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                                    "itemValue": "Malware"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "primitive",
                                "field": "source",
                                "value": "Symantec EDR",
                                "operator": "eq",
                                "_operator": "eq"
                            },
                            {
                                "type": "object",
                                "field": "status",
                                "value": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                                    "display": "Open",
                                    "itemValue": "Open"
                                },
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "df740be8-f2e7-488d-bc6c-747b7d19ab49"
        },
        {
            "@type": "WorkflowStep",
            "name": "Find Indicators",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "id",
                            "value": "{{vars.input.records[0].id}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ],
                    "__selectFields": [
                        "indicators"
                    ]
                },
                "module": "alerts?$limit=30&$relationships=true",
                "checkboxFields": true,
                "step_variables": []
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "uuid": "75734585-7f12-484b-a04b-9a1e59501778"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Get File Reputation -> Is Endpoint Isolation Required",
            "targetStep": "\/api\/3\/workflow_steps\/de65e2b0-8e90-4e52-9322-02e554ecc731",
            "sourceStep": "\/api\/3\/workflow_steps\/d584d6cc-1d03-4b83-902b-184fafe7c363",
            "label": null,
            "isExecuted": false,
            "uuid": "14920693-bbd3-4e32-9f53-e144f78ac8f9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> No Isolation is required",
            "targetStep": "\/api\/3\/workflow_steps\/db4d346e-1911-440d-9464-6da79acdf991",
            "sourceStep": "\/api\/3\/workflow_steps\/7961d045-80f6-4ff5-8510-18df8af36cda",
            "label": "Reject",
            "isExecuted": false,
            "uuid": "a7b95726-484b-4843-89b0-cb8424a60eff"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Fetch Assets Details",
            "targetStep": "\/api\/3\/workflow_steps\/a9e65d2c-8da2-4691-92a3-7dc71d49ec80",
            "sourceStep": "\/api\/3\/workflow_steps\/73d170ed-171d-4299-ac09-146e18bf66e0",
            "label": null,
            "isExecuted": false,
            "uuid": "6749a76a-c223-4c40-92b6-3f4173adfdb4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Endpoint Isolation Required -> No malicious file found1",
            "targetStep": "\/api\/3\/workflow_steps\/95d6ceb4-e47d-40db-a3cf-c83212b701c4",
            "sourceStep": "\/api\/3\/workflow_steps\/de65e2b0-8e90-4e52-9322-02e554ecc731",
            "label": "No",
            "isExecuted": false,
            "uuid": "5e56bf07-3acf-479d-87b7-ed9560d6c4e4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch Assets Details -> Create or Link Assets",
            "targetStep": "\/api\/3\/workflow_steps\/40b3a444-cdc6-4e62-897e-cfd27e22d886",
            "sourceStep": "\/api\/3\/workflow_steps\/a9e65d2c-8da2-4691-92a3-7dc71d49ec80",
            "label": null,
            "isExecuted": false,
            "uuid": "db8e86a0-e524-4800-a203-fe30ec7bf29a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Seek approval to contain -> Create Note for Approved Isolation",
            "targetStep": "\/api\/3\/workflow_steps\/69153dc8-0b1f-4a7d-9f5e-e0960d183a86",
            "sourceStep": "\/api\/3\/workflow_steps\/7961d045-80f6-4ff5-8510-18df8af36cda",
            "label": "Approve",
            "isExecuted": false,
            "uuid": "022fc8ac-928d-40e6-8fa1-6cc7bcf80470"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/73d170ed-171d-4299-ac09-146e18bf66e0",
            "sourceStep": "\/api\/3\/workflow_steps\/c787c8b3-52a2-4572-94f1-04353385c2b2",
            "label": null,
            "isExecuted": false,
            "uuid": "ad80d8f4-c269-4eca-b673-8fa2d72d1a0b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "is Endpoint Isolation Required -> Create note for the approval",
            "targetStep": "\/api\/3\/workflow_steps\/858ed5ba-8133-48c0-bb12-53efa9bd9310",
            "sourceStep": "\/api\/3\/workflow_steps\/de65e2b0-8e90-4e52-9322-02e554ecc731",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "bfe7ac61-68e7-44d0-895b-4c3db4fbee6c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create note for the approval -> Seek approval to contain",
            "targetStep": "\/api\/3\/workflow_steps\/7961d045-80f6-4ff5-8510-18df8af36cda",
            "sourceStep": "\/api\/3\/workflow_steps\/858ed5ba-8133-48c0-bb12-53efa9bd9310",
            "label": null,
            "isExecuted": false,
            "uuid": "2210a602-a029-46f0-a754-6324f442976e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify IT team to start the asset clean up process -> Closing Alert record",
            "targetStep": "\/api\/3\/workflow_steps\/be20c511-16db-4f72-b20c-9169fe76f7ce",
            "sourceStep": "\/api\/3\/workflow_steps\/a4a78348-4308-40c5-9fcf-e430786124f3",
            "label": null,
            "isExecuted": false,
            "uuid": "3b2f46ac-f48d-49fc-a61c-d602ceb34365"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create or Link Assets -> Get File Reputation",
            "targetStep": "\/api\/3\/workflow_steps\/d584d6cc-1d03-4b83-902b-184fafe7c363",
            "sourceStep": "\/api\/3\/workflow_steps\/40b3a444-cdc6-4e62-897e-cfd27e22d886",
            "label": null,
            "isExecuted": false,
            "uuid": "100979c5-5553-4253-8f51-e646d5b5ecd5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Deactivate User in CloudSOC -> Notify IT team to start the asset clean up process",
            "targetStep": "\/api\/3\/workflow_steps\/a4a78348-4308-40c5-9fcf-e430786124f3",
            "sourceStep": "\/api\/3\/workflow_steps\/debec9e7-c5ea-4440-be9a-5dc0724f9cec",
            "label": null,
            "isExecuted": false,
            "uuid": "910e2c08-db39-4096-a6cc-fd595ab0c70c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for Approved Isolation -> Delete File from Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/e3d72c73-d3e0-4900-b61d-ea442d514fd9",
            "sourceStep": "\/api\/3\/workflow_steps\/69153dc8-0b1f-4a7d-9f5e-e0960d183a86",
            "label": null,
            "isExecuted": false,
            "uuid": "7b1dca19-b6be-482f-8604-959a85f7fd57"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Delete File from Endpoint -> Isolate Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/96e0594d-b578-4b45-aa0a-acba89cdb6af",
            "sourceStep": "\/api\/3\/workflow_steps\/e3d72c73-d3e0-4900-b61d-ea442d514fd9",
            "label": null,
            "isExecuted": false,
            "uuid": "eef9fadb-6ee9-43c8-aace-a2fca4673356"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Isolate Endpoint -> Deactivate User in CloudSOC",
            "targetStep": "\/api\/3\/workflow_steps\/debec9e7-c5ea-4440-be9a-5dc0724f9cec",
            "sourceStep": "\/api\/3\/workflow_steps\/96e0594d-b578-4b45-aa0a-acba89cdb6af",
            "label": null,
            "isExecuted": false,
            "uuid": "7a8bb1e5-2209-462b-a7dd-06d5264a9cb4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Find Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/75734585-7f12-484b-a04b-9a1e59501778",
            "sourceStep": "\/api\/3\/workflow_steps\/df740be8-f2e7-488d-bc6c-747b7d19ab49",
            "label": null,
            "isExecuted": false,
            "uuid": "851418ca-5df3-4635-a02e-498f5eacaa95"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Find Indicators -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/c787c8b3-52a2-4572-94f1-04353385c2b2",
            "sourceStep": "\/api\/3\/workflow_steps\/75734585-7f12-484b-a04b-9a1e59501778",
            "label": null,
            "isExecuted": false,
            "uuid": "84b9e2f1-2afd-449f-8411-c7ccddd0ee3d"
        }
    ],
    "priority": null,
    "uuid": "3f11ef71-f1c7-497d-af2d-9f9b6be061d0",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": []
}